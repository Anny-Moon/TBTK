CC = g++
CFLAGS = -Wall -std=c++11
NVCCFLAGS = -std=c++11

HOPPING_AMPLITUDE_SOURCE = src/HoppingAmplitude.cpp
TREE_NODE_SOURCE = src/TreeNode.cpp
AMPLITUDE_SET_SOURCE = src/AmplitudeSet.cpp
MODEL_SOURCE = src/Model.cpp
PROPERTY_EXTRACTOR_SOURCE = src/PropertyExtractor.cpp
FILE_WRITER_SOURCE = src/FileWriter.cpp
HA_LINKED_LIST_SOURCE = src/HALinkedList.cpp
CHEBYSHEV_SOLVER_SOURCE = src/ChebyshevSolver.cpp
CHEBYSHEV_SOLVER_CUDA_SOURCE = src/ChebyshevSolver.cu
SOURCES = $(HOPPING_AMPLITUDE_SOURCE)
SOURCES += $(TREE_NODE_SOURCE)
SOURCES += $(AMPLITUDE_SET_SOURCE)
SOURCES += $(MODEL_SOURCE)
SOURCES += $(PROPERTY_EXTRACTOR_SOURCE)
SOURCES += $(FILE_WRITER_SOURCE)
SOURCES += $(HA_LINKED_LIST_SOURCE)
SOURCES += $(CHEBYSHEV_SOLVER_SOURCE)
SOURCES += $(CHEBYSHEV_SOLVER_CUDA_SOURCE)

HOPPING_AMPLITUDE_OBJECT = build/HoppingAmplitude.o
TREE_NODE_OBJECT = build/TreeNode.o
AMPLITUDE_SET_OBJECT = build/AmplitudeSet.o
MODEL_OBJECT = build/Model.o
PROPERTY_EXTRACTOR_OBJECT = build/PropertyExtractor.o
FILE_WRITER_OBJECT = build/FileWriter.o
HA_LINKED_LIST_OBJECT = build/HALinkedList.o
CHEBYSHEV_SOLVER_OBJECT = build/ChebyshevSolver.o
CHEBYSHEV_SOLVER_CUDA_OBJECT = build/ChebyshevSolverCUDA.o
OBJECTS = $(HOPPING_AMPLITUDE_OBJECT)
OBJECTS += $(TREE_NODE_OBJECT)
OBJECTS += $(AMPLITUDE_SET_OBJECT)
OBJECTS += $(MODEL_OBJECT)
OBJECTS += $(PROPERTY_EXTRACTOR_OBJECT)
OBJECTS += $(FILE_WRITER_OBJECT)
OBJECTS += $(HA_LINKED_LIST_OBJECT)
OBJECTS += $(CHEBYSHEV_SOLVER_OBJECT)
OBJECTS += $(CHEBYSHEV_SOLVER_CUDA_OBJECT)

TIGHT_BINDING_LIB_STATIC = build/libTightBinding.a


all: $(TIGHT_BINDING_LIB_STATIC)

$(TIGHT_BINDING_LIB_STATIC): $(OBJECTS)
	ar rcs $(TIGHT_BINDING_LIB_STATIC) $(OBJECTS)

$(HOPPING_AMPLITUDE_OBJECT): $(HOPPING_AMPLITUDE_SOURCE)
	$(CC) $(CFLAGS) -c $(HOPPING_AMPLITUDE_SOURCE) -o $(HOPPING_AMPLITUDE_OBJECT)

$(TREE_NODE_OBJECT): $(TREE_NODE_SOURCE)
	$(CC) $(CFLAGS) -c $(TREE_NODE_SOURCE) -o $(TREE_NODE_OBJECT)

$(AMPLITUDE_SET_OBJECT): $(AMPLITUDE_SET_SOURCE)
	$(CC) $(CFLAGS) -c $(AMPLITUDE_SET_SOURCE) -o $(AMPLITUDE_SET_OBJECT)

$(MODEL_OBJECT): $(MODEL_SOURCE)
	$(CC) $(CFLAGS) -c $(MODEL_SOURCE) -o $(MODEL_OBJECT)

$(PROPERTY_EXTRACTOR_OBJECT): $(PROPERTY_EXTRACTOR_SOURCE)
	$(CC) $(CFLAGS) -c $(PROPERTY_EXTRACTOR_SOURCE) -o $(PROPERTY_EXTRACTOR_OBJECT)

$(FILE_WRITER_OBJECT): $(FILE_WRITER_SOURCE)
#	$(CC) $(CFLAGS) -c $(FILE_WRITER_SOURCE) -o $(FILE_WRITER_OBJECT)
	$(CC) $(CFLAGS) -I../../../hdf5/hdf5-build/hdf5/include -I../../../hdf5/hdf5-1.8.16/include -c $(FILE_WRITER_SOURCE) -o $(FILE_WRITER_OBJECT)

$(HA_LINKED_LIST_OBJECT): $(HA_LINKED_LIST_SOURCE)
	$(CC) $(CFLAGS) -c $(HA_LINKED_LIST_SOURCE) -o $(HA_LINKED_LIST_OBJECT)

$(CHEBYSHEV_SOLVER_OBJECT): $(CHEBYSHEV_SOLVER_SOURCE)
	$(CC) $(CFLAGS) -c $(CHEBYSHEV_SOLVER_SOURCE) -o $(CHEBYSHEV_SOLVER_OBJECT)

$(CHEBYSHEV_SOLVER_CUDA_OBJECT): $(CHEBYSHEV_SOLVER_CUDA_SOURCE)
	nvcc $(NVCCFLAGS) -c $(CHEBYSHEV_SOLVER_CUDA_SOURCE) -o $(CHEBYSHEV_SOLVER_CUDA_OBJECT)


clean:
	rm -r build/*

